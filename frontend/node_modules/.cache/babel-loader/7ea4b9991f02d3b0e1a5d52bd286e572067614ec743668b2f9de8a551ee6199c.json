{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState } from \"react\";\nimport axios from \"axios\";\nconst API_BASE = process.env.REACT_APP_API_URL || \"http://localhost:8000\";\nexport function useProtocolGenerator() {\n  _s();\n  const [state, setState] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(\"\");\n  const generate = async (userIntent, originalQuery) => {\n    setLoading(true);\n    setError(\"\");\n    try {\n      const response = await axios.post(`${API_BASE}/generate`, {\n        user_intent: userIntent,\n        original_query: originalQuery\n      });\n      const data = response.data;\n      setState({\n        thread_id: data.thread_id,\n        status: data.status,\n        current_draft: data.current_draft,\n        safety_flags: data.safety_flags,\n        clinical_feedback: data.clinical_feedback,\n        empathy_score: data.empathy_score,\n        safety_score: data.safety_score,\n        agent_notes: data.agent_notes,\n        iteration_count: data.iteration_count\n      });\n    } catch (err) {\n      var _err$response, _err$response$data;\n      const errorMsg = ((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.detail) || \"Generation failed\";\n      setError(errorMsg);\n    } finally {\n      setLoading(false);\n    }\n  };\n  const approve = async (threadId, edits = \"\") => {\n    setLoading(true);\n    try {\n      const response = await axios.post(`${API_BASE}/approve`, {\n        thread_id: threadId,\n        human_approval: true,\n        human_edits: edits\n      });\n      const data = response.data;\n      setState(prev => prev ? {\n        ...prev,\n        status: data.status,\n        current_draft: data.final_protocol\n      } : null);\n    } catch (err) {\n      var _err$response2, _err$response2$data;\n      const errorMsg = ((_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : (_err$response2$data = _err$response2.data) === null || _err$response2$data === void 0 ? void 0 : _err$response2$data.detail) || \"Approval failed\";\n      setError(errorMsg);\n    } finally {\n      setLoading(false);\n    }\n  };\n  return {\n    state,\n    loading,\n    error,\n    generate,\n    approve\n  };\n}\n_s(useProtocolGenerator, \"yaXUEZPeh5Vn/zyIIW6Q8K7tK60=\");","map":{"version":3,"names":["useState","axios","API_BASE","process","env","REACT_APP_API_URL","useProtocolGenerator","_s","state","setState","loading","setLoading","error","setError","generate","userIntent","originalQuery","response","post","user_intent","original_query","data","thread_id","status","current_draft","safety_flags","clinical_feedback","empathy_score","safety_score","agent_notes","iteration_count","err","_err$response","_err$response$data","errorMsg","detail","approve","threadId","edits","human_approval","human_edits","prev","final_protocol","_err$response2","_err$response2$data"],"sources":["/Users/mayankkathane/Projects/Cerina Foundary/frontend/src/hooks/useProtocolGenerator.ts"],"sourcesContent":["import { useState } from \"react\";\nimport axios from \"axios\";\nimport { ProtocolState, ProtocolResponse, ApprovalResponse } from \"../types\";\n\nconst API_BASE = process.env.REACT_APP_API_URL || \"http://localhost:8000\";\n\nexport function useProtocolGenerator() {\n  const [state, setState] = useState<ProtocolState | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(\"\");\n\n  const generate = async (userIntent: string, originalQuery: string) => {\n    setLoading(true);\n    setError(\"\");\n    try {\n      const response = await axios.post(`${API_BASE}/generate`, {\n        user_intent: userIntent,\n        original_query: originalQuery,\n      });\n      \n      const data = response.data as ProtocolResponse;\n      setState({\n        thread_id: data.thread_id,\n        status: data.status,\n        current_draft: data.current_draft,\n        safety_flags: data.safety_flags,\n        clinical_feedback: data.clinical_feedback,\n        empathy_score: data.empathy_score,\n        safety_score: data.safety_score,\n        agent_notes: data.agent_notes,\n        iteration_count: data.iteration_count,\n      });\n    } catch (err: any) {\n      const errorMsg = err.response?.data?.detail || \"Generation failed\";\n      setError(errorMsg);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const approve = async (threadId: string, edits: string = \"\") => {\n    setLoading(true);\n    try {\n      const response = await axios.post(`${API_BASE}/approve`, {\n        thread_id: threadId,\n        human_approval: true,\n        human_edits: edits,\n      });\n\n      const data = response.data as ApprovalResponse;\n      setState((prev) => \n        prev ? {\n          ...prev,\n          status: data.status,\n          current_draft: data.final_protocol,\n        } : null\n      );\n    } catch (err: any) {\n      const errorMsg = err.response?.data?.detail || \"Approval failed\";\n      setError(errorMsg);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return { state, loading, error, generate, approve };\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}