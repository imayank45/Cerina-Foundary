{"ast":null,"code":"var _s = $RefreshSig$();\n// import { useState } from \"react\";\n// import axios from \"axios\";\n// import { ProtocolState, ProtocolResponse, ApprovalResponse } from \"../types\";\n\n// const API_BASE = process.env.REACT_APP_API_URL || \"http://localhost:8000\";\n\n// export function useProtocolGenerator() {\n//   const [state, setState] = useState<ProtocolState | null>(null);\n//   const [loading, setLoading] = useState(false);\n//   const [error, setError] = useState(\"\");\n\n//   const generate = async (userIntent: string, originalQuery: string) => {\n//     setLoading(true);\n//     setError(\"\");\n//     try {\n//       const response = await axios.post(`${API_BASE}/generate`, {\n//         user_intent: userIntent,\n//         original_query: originalQuery,\n//       });\n\n//       const data = response.data as ProtocolResponse;\n//       setState({\n//         thread_id: data.thread_id,\n//         status: data.status,\n//         current_draft: data.current_draft,\n//         safety_flags: data.safety_flags,\n//         clinical_feedback: data.clinical_feedback,\n//         empathy_score: data.empathy_score,\n//         safety_score: data.safety_score,\n//         agent_notes: data.agent_notes,\n//         iteration_count: data.iteration_count,\n//       });\n//     } catch (err: any) {\n//       const errorMsg = err.response?.data?.detail || \"Generation failed\";\n//       setError(errorMsg);\n//     } finally {\n//       setLoading(false);\n//     }\n//   };\n\n//   const approve = async (threadId: string, edits: string = \"\") => {\n//     setLoading(true);\n//     try {\n//       const response = await axios.post(`${API_BASE}/approve`, {\n//         thread_id: threadId,\n//         human_approval: true,\n//         human_edits: edits,\n//       });\n\n//       const data = response.data as ApprovalResponse;\n//       setState((prev) => \n//         prev ? {\n//           ...prev,\n//           status: data.status,\n//           current_draft: data.final_protocol,\n//         } : null\n//       );\n//     } catch (err: any) {\n//       const errorMsg = err.response?.data?.detail || \"Approval failed\";\n//       setError(errorMsg);\n//     } finally {\n//       setLoading(false);\n//     }\n//   };\n\n//   return { state, loading, error, generate, approve };\n// }\n\nimport { useState } from \"react\";\nimport axios from \"axios\";\nconst API_BASE = process.env.REACT_APP_API_URL || \"http://localhost:8000\";\nexport function useProtocolGenerator() {\n  _s();\n  const [state, setState] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(\"\");\n  const generate = async (userIntent, originalQuery) => {\n    setLoading(true);\n    setError(\"\");\n    try {\n      const response = await axios.post(`${API_BASE}/generate`, {\n        user_intent: userIntent,\n        original_query: originalQuery\n      });\n      const data = response.data;\n      console.log(\"GENERATE response:\", data);\n\n      // Direct 1:1 mapping\n      const nextState = {\n        thread_id: data.thread_id,\n        status: data.status,\n        current_draft: data.current_draft,\n        safety_flags: data.safety_flags,\n        clinical_feedback: data.clinical_feedback,\n        empathy_score: data.empathy_score,\n        safety_score: data.safety_score,\n        agent_notes: data.agent_notes,\n        iteration_count: data.iteration_count\n      };\n      setState(nextState);\n    } catch (err) {\n      var _err$response, _err$response$data;\n      console.error(\"GENERATE error:\", err);\n      const errorMsg = ((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.detail) || \"Generation failed\";\n      setError(errorMsg);\n    } finally {\n      setLoading(false);\n    }\n  };\n  const approve = async (threadId, edits = \"\") => {\n    setLoading(true);\n    setError(\"\");\n    try {\n      const response = await axios.post(`${API_BASE}/approve`, {\n        thread_id: threadId,\n        human_approval: true,\n        human_edits: edits\n      });\n      const data = response.data;\n      console.log(\"APPROVE response:\", data);\n      setState(prev => prev ? {\n        ...prev,\n        status: data.status,\n        current_draft: data.final_protocol\n      } : null);\n    } catch (err) {\n      var _err$response2, _err$response2$data;\n      console.error(\"APPROVE error:\", err);\n      const errorMsg = ((_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : (_err$response2$data = _err$response2.data) === null || _err$response2$data === void 0 ? void 0 : _err$response2$data.detail) || \"Approval failed\";\n      setError(errorMsg);\n    } finally {\n      setLoading(false);\n    }\n  };\n  return {\n    state,\n    loading,\n    error,\n    generate,\n    approve\n  };\n}\n_s(useProtocolGenerator, \"yaXUEZPeh5Vn/zyIIW6Q8K7tK60=\");","map":{"version":3,"names":["useState","axios","API_BASE","process","env","REACT_APP_API_URL","useProtocolGenerator","_s","state","setState","loading","setLoading","error","setError","generate","userIntent","originalQuery","response","post","user_intent","original_query","data","console","log","nextState","thread_id","status","current_draft","safety_flags","clinical_feedback","empathy_score","safety_score","agent_notes","iteration_count","err","_err$response","_err$response$data","errorMsg","detail","approve","threadId","edits","human_approval","human_edits","prev","final_protocol","_err$response2","_err$response2$data"],"sources":["/Users/mayankkathane/Projects/Cerina Foundary/frontend/src/hooks/useProtocolGenerator.ts"],"sourcesContent":["// import { useState } from \"react\";\n// import axios from \"axios\";\n// import { ProtocolState, ProtocolResponse, ApprovalResponse } from \"../types\";\n\n// const API_BASE = process.env.REACT_APP_API_URL || \"http://localhost:8000\";\n\n// export function useProtocolGenerator() {\n//   const [state, setState] = useState<ProtocolState | null>(null);\n//   const [loading, setLoading] = useState(false);\n//   const [error, setError] = useState(\"\");\n\n//   const generate = async (userIntent: string, originalQuery: string) => {\n//     setLoading(true);\n//     setError(\"\");\n//     try {\n//       const response = await axios.post(`${API_BASE}/generate`, {\n//         user_intent: userIntent,\n//         original_query: originalQuery,\n//       });\n      \n//       const data = response.data as ProtocolResponse;\n//       setState({\n//         thread_id: data.thread_id,\n//         status: data.status,\n//         current_draft: data.current_draft,\n//         safety_flags: data.safety_flags,\n//         clinical_feedback: data.clinical_feedback,\n//         empathy_score: data.empathy_score,\n//         safety_score: data.safety_score,\n//         agent_notes: data.agent_notes,\n//         iteration_count: data.iteration_count,\n//       });\n//     } catch (err: any) {\n//       const errorMsg = err.response?.data?.detail || \"Generation failed\";\n//       setError(errorMsg);\n//     } finally {\n//       setLoading(false);\n//     }\n//   };\n\n//   const approve = async (threadId: string, edits: string = \"\") => {\n//     setLoading(true);\n//     try {\n//       const response = await axios.post(`${API_BASE}/approve`, {\n//         thread_id: threadId,\n//         human_approval: true,\n//         human_edits: edits,\n//       });\n\n//       const data = response.data as ApprovalResponse;\n//       setState((prev) => \n//         prev ? {\n//           ...prev,\n//           status: data.status,\n//           current_draft: data.final_protocol,\n//         } : null\n//       );\n//     } catch (err: any) {\n//       const errorMsg = err.response?.data?.detail || \"Approval failed\";\n//       setError(errorMsg);\n//     } finally {\n//       setLoading(false);\n//     }\n//   };\n\n//   return { state, loading, error, generate, approve };\n// }\n\n\nimport { useState } from \"react\";\nimport axios from \"axios\";\nimport { ProtocolState, ProtocolResponse, ApprovalResponse } from \"../types\";\n\nconst API_BASE = process.env.REACT_APP_API_URL || \"http://localhost:8000\";\n\nexport function useProtocolGenerator() {\n  const [state, setState] = useState<ProtocolState | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(\"\");\n\n  const generate = async (userIntent: string, originalQuery: string) => {\n    setLoading(true);\n    setError(\"\");\n    try {\n      const response = await axios.post<ProtocolResponse>(`${API_BASE}/generate`, {\n        user_intent: userIntent,\n        original_query: originalQuery,\n      });\n\n      const data = response.data;\n      console.log(\"GENERATE response:\", data);\n\n      // Direct 1:1 mapping\n      const nextState: ProtocolState = {\n        thread_id: data.thread_id,\n        status: data.status as ProtocolState[\"status\"],\n        current_draft: data.current_draft,\n        safety_flags: data.safety_flags,\n        clinical_feedback: data.clinical_feedback,\n        empathy_score: data.empathy_score,\n        safety_score: data.safety_score,\n        agent_notes: data.agent_notes,\n        iteration_count: data.iteration_count,\n      };\n\n      setState(nextState);\n    } catch (err: any) {\n      console.error(\"GENERATE error:\", err);\n      const errorMsg = err.response?.data?.detail || \"Generation failed\";\n      setError(errorMsg);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const approve = async (threadId: string, edits: string = \"\") => {\n    setLoading(true);\n    setError(\"\");\n    try {\n      const response = await axios.post<ApprovalResponse>(`${API_BASE}/approve`, {\n        thread_id: threadId,\n        human_approval: true,\n        human_edits: edits,\n      });\n\n      const data = response.data;\n      console.log(\"APPROVE response:\", data);\n\n      setState((prev) =>\n        prev\n          ? {\n              ...prev,\n              status: data.status as ProtocolState[\"status\"],\n              current_draft: data.final_protocol,\n            }\n          : null\n      );\n    } catch (err: any) {\n      console.error(\"APPROVE error:\", err);\n      const errorMsg = err.response?.data?.detail || \"Approval failed\";\n      setError(errorMsg);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return { state, loading, error, generate, approve };\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}